---
categories:
  - Freetime
layout: post
image:
  path: hacking.png
media_subpath: /assets/posts/2026-02-27-Wazuh
tags:
  - Experiencing
  - Freetime
  - BurnoutSurvivor
  - 
title: Homelab - Wazuh Deployment
---
## Description

Migrated all my container services (Gitlab & Postgresql) to a single node in Proxmox and wanted to have space for some kind of system, which would gather logs and events from endpoints. This another single node has 8 cores and 16gb ram for Wazuh SIEM & XDR solution. Deployment is pretty straightforward and needs the core components (Wazuh Indexer, Wazuh Manager, Wazuh Dashboard and Filebeat). These will be included in the virtual machine image (.ova). In the future I would want to make a simple program to format and forward all the logs into Postgres database.

- Wazuh official site : <https://wazuh.com/>
- Virtual Machine deployment guide and images : <https://documentation.wazuh.com/current/deployment-options/virtual-machine/virtual-machine.html>

## Deployment


Starting up by copying the image into my NAS-server.
![](2026-02-27-10-03-36.png)

Creating a new empty virtual machine and allocated enough resources for cores and ram : Wazuh recommendation (4 cores & 8GB RAM)
![](2026-02-27-10-12-12.png)

Transferring the image from mounted storage : 
````
root@pve3:/mnt/pve/NAS/ProxmoxVM/Wazuh# cp wazuh-4.14.3.ova /var/lib/vz/template/iso/
````

Extracting files from the image (.ova)
````
root@pve3:/var/lib/vz/template/iso# tar -xvf wazuh-4.14.3.ova
wazuh-4.14.3.ovf
wazuh-4.14.3-disk-1.vmdk
wazuh-4.14.3.mf
````

Importing the (.vmdk) into the empty VM:

````
root@pve3:/var/lib/vz/template/iso# qm importdisk 105 wazuh-4.14.3-disk-1.vmdk local-lvm --format raw
importing disk 'wazuh-4.14.3-disk-1.vmdk' to VM 105 ...
  Logical volume "vm-105-disk-0" created.
  Logical volume pve/vm-105-disk-0 changed.
transferred 0.0 B of 25.0 GiB (0.00%)
transferred 256.0 MiB of 25.0 GiB (1.00%)
transferred 512.0 MiB of 25.0 GiB (2.00%)
transferred 768.0 MiB of 25.0 GiB (3.00%)
transferred 1.0 GiB of 25.0 GiB (4.00%)
transferred 1.2 GiB of 25.0 GiB (5.00%)
transferred 1.5 GiB of 25.0 GiB (6.00%)
transferred 1.8 GiB of 25.0 GiB (7.00%)
transferred 2.0 GiB of 25.0 GiB (8.00%)
````

Assigning the imported disk for the VM & changing the boot order:

![](2026-02-27-10-31-05.png)

![](2026-02-27-10-34-52.png)


Virtual machine will boot straight into fresh deployment, no need for additional configuration and the dashboard can be accessed via the IP. 

Default creds : (admin/admin)

![](2026-02-27-11-04-40.png)

The dashboard itself is really compact.

![](2026-02-27-11-06-29.png)


Deploying new agents is really easy. Supported OS's are Linux, Windows and both Apple Silicon and Intel. For demo purposes I can deploy one agent to my virtual Windows Server 2022 in Proxmox. These parameters in the UI will generate a prompt, depending on the OS. It will install the Wazuh-agent to the endpoint.

![](2026-02-27-11-10-16.png)

Specifying the Wazuh(VM) IP-address in the local network, since this is only for local purposes.

![](2026-02-27-11-11-46.png)

Unique agent name:

![](2026-02-27-11-12-41.png)

Powershell-command generated, since target endpoint is Windows : 

````
Invoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.14.3-1.msi -OutFile $env:tmp\wazuh-agent; msiexec.exe /i $env:tmp\wazuh-agent /q WAZUH_MANAGER='192.168.1.236' WAZUH_AGENT_NAME='WindowsServer2022'
````

After executing, start the agent:
````
NET START Wazuh
````

Meanwhile noticed that I need to allocate more memory for the VM:
![](2026-02-27-11-15-19.png)

Opening up Powershell:

![](2026-02-27-11-16-05.png)

To be honest I wrote it down into the terminal because this VNC window in Proxmox will not allow to copypaste the command:

![](2026-02-27-11-20-59.png)

Typical thing, things won't work. The connection between servers work though. 

![](2026-02-27-11-22-57.png)

So the guide in the deployment page had wrong command for starting the service:

![](2026-02-27-11-25-22.png)

Finally the agent is talking to the Wazuh-server and can be seen in the *Endpoints* section:

![](2026-02-27-11-26-36.png)